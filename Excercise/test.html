<p>Dear Conal,</p>
<blockquote>
<p>Would you mind re-sending your note below (to which I’m responding)
and its P.S. as Markdown?</p>
</blockquote>
<p>Sure, I have created the Markdown file, but when I display it, the
formatting does not look as intended.</p>
<blockquote>
<p>Wow—you’ve taken to Agda very well! I hope you’re having fun with it
(as I am).</p>
</blockquote>
<p>Thank you for encouraging me with Agda - I am finding it both
challenging and rewarding .I am enjoying the challenge and rewards that
Agda brings, and it is also intriguing to ponder on the relationship
between logic, philosophy and programming while using Agda.</p>
<blockquote>
<p> in MonoidH, what role do the instance arguments play? In other
words, how do the monoid laws affect the notion of a monoid
homomorphism? Likewise for semiring homomorphisms.</p>
</blockquote>
<p>Thank you. I see the issue with my implementation that I didn’t use
any properties of the monoids to prove that (x ^_) is a homomorphism. I
think I should only use properties of (x ^_), monoid properties of
domain and codomain to prove that. I have come up with an implementation
but I’m not satisfied with it: - I’m not sure of it’s correct to
implement <code>monoidₘ</code> , <code>monoidₙ</code> as record field of
<code>MonoidH</code> is right way to express the monoid constraint. -
I’ve to explicitly pass <code>ℕ*-monoid</code> instance.</p>
<!--
```agda
import Relation.Binary.PropositionalEquality as Eq
open Eq using (_≡_; refl; sym; trans; cong; cong-app)
open Eq.≡-Reasoning

data ℕ : Set where
  zero : ℕ
  suc : ℕ → ℕ
{-# BUILTIN NATURAL ℕ #-}

infixl 6  _+_
_+_ : ℕ → ℕ → ℕ
zero + n = n
suc m + n = suc (m + n)
```
Proving (ℕ , _+_ , zero) is monoid

```agda
+-identityˡ : ∀ (n : ℕ) → zero + n ≡ n
+-identityˡ n = refl

+-identityʳ : ∀ (n : ℕ) → n + zero ≡ n
+-identityʳ zero = refl
+-identityʳ (suc n) =
  begin
    suc n + zero
    ≡⟨⟩ -- _+_ definition
    suc (n + zero)
    ≡⟨ cong suc (+-identityʳ n) ⟩
    suc n
  ∎

+-assoc : ∀ (m n p : ℕ) → (m + n) + p ≡ m + (n + p)
+-assoc zero n p = refl
+-assoc (suc m) n p rewrite +-assoc m n p = refl

infixl 7 _*_
_*_ : ℕ → ℕ → ℕ
zero * n = zero
suc m * n = n + (m * n)

-- proving (ℕ , _*_, 1) is monoid

*-identityˡ : ∀ (n : ℕ) → 1 * n ≡ n
*-identityˡ n rewrite +-identityʳ n = refl

*-identityʳ : ∀ (n : ℕ) → n * 1 ≡ n
*-identityʳ zero = refl
*-identityʳ (suc n) rewrite *-identityʳ n = refl

-- to prove *-assoc, we need to prove *-distrib-+
*-distribʳ-+ : ∀ (m n p : ℕ) → (m + n) * p ≡ m * p + n * p
*-distribʳ-+ zero n p = refl
*-distribʳ-+ (suc m) n p
  rewrite *-distribʳ-+ m n p
  | sym (+-assoc p (m * p) (n * p)) = refl

*-assoc : ∀ (m n p : ℕ) → (m * n) * p ≡ m * (n * p)
*-assoc zero n p = refl
*-assoc (suc m) n p
  rewrite *-distribʳ-+ n (m * n) p
  | *-assoc m n p
  = refl

infixr 8 _^_
_^_ : ℕ → ℕ → ℕ
m ^ zero = 1
m ^ suc n = m * (m ^ n)

```
-->
<div class="sourceCode" id="cb1"><pre
class="sourceCode agda"><code class="sourceCode agda"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">record</span> Monoid <span class="ot">{</span>A <span class="ot">:</span> <span class="dt">Set</span><span class="ot">}</span> <span class="ot">(</span>e <span class="ot">:</span> A<span class="ot">)</span> <span class="ot">(_</span>∙<span class="ot">_</span> <span class="ot">:</span> A <span class="ot">→</span> A <span class="ot">→</span> A<span class="ot">)</span> <span class="ot">:</span> <span class="dt">Set</span> <span class="kw">where</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">field</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    ∙-identityʳ <span class="ot">:</span> <span class="ot">∀</span> <span class="ot">(</span>a <span class="ot">:</span> A<span class="ot">)</span> <span class="ot">→</span> a ∙ e ≡ a</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    ∙-identityˡ <span class="ot">:</span> <span class="ot">∀</span> <span class="ot">(</span>a <span class="ot">:</span> A<span class="ot">)</span> <span class="ot">→</span> e ∙ a ≡ a</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    ∙-assoc <span class="ot">:</span> <span class="ot">∀</span> <span class="ot">(</span>a b c <span class="ot">:</span> A<span class="ot">)</span> <span class="ot">→</span> <span class="ot">(</span>a ∙ b<span class="ot">)</span> ∙ c ≡ a ∙ <span class="ot">(</span>b ∙ c<span class="ot">)</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">open</span> Monoid ⦃ <span class="ot">...</span> ⦄ <span class="kw">public</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">-- proof that (ℕ, _+_ , 0) is monoid</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="kw">instance</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  ℕ+-monoid <span class="ot">:</span> Monoid <span class="dv">0</span> <span class="ot">_</span>+<span class="ot">_</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  ℕ+-monoid <span class="ot">=</span> <span class="kw">record</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="ot">{</span> ∙-identityʳ <span class="ot">=</span> +-identityʳ</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="ot">;</span> ∙-identityˡ <span class="ot">=</span> +-identityˡ</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="ot">;</span> ∙-assoc <span class="ot">=</span> +-assoc</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="ot">}</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co">-- proof that (ℕ, _*_ , 1) is monoid</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="kw">instance</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  ℕ*-monoid <span class="ot">:</span> Monoid <span class="dv">1</span> <span class="ot">_</span>*<span class="ot">_</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  ℕ*-monoid <span class="ot">=</span> <span class="kw">record</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="ot">{</span> ∙-identityʳ <span class="ot">=</span> *-identityʳ</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="ot">;</span> ∙-identityˡ <span class="ot">=</span> *-identityˡ</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="ot">;</span> ∙-assoc <span class="ot">=</span> *-assoc</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="ot">}</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="kw">record</span> MonoidH</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="ot">{</span>M N <span class="ot">:</span> <span class="dt">Set</span><span class="ot">}</span> <span class="ot">(</span>eₘ <span class="ot">:</span> M<span class="ot">)</span> <span class="ot">(_</span>∙ₘ<span class="ot">_</span> <span class="ot">:</span> M <span class="ot">→</span> M <span class="ot">→</span> M<span class="ot">)</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    <span class="ot">(</span>eₙ <span class="ot">:</span> N<span class="ot">)</span> <span class="ot">(_</span>∙ₙ<span class="ot">_</span> <span class="ot">:</span> N <span class="ot">→</span> N <span class="ot">→</span> N<span class="ot">)</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="ot">(</span>f <span class="ot">:</span> M <span class="ot">→</span> N<span class="ot">)</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="ot">:</span> <span class="dt">Set</span> <span class="kw">where</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="kw">field</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    P-∙ <span class="ot">:</span> <span class="ot">∀</span> <span class="ot">(</span>a b <span class="ot">:</span> M<span class="ot">)</span> <span class="ot">→</span> f <span class="ot">(</span>a ∙ₘ b<span class="ot">)</span> ≡ f a ∙ₙ f b</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    P-id <span class="ot">:</span> f eₘ ≡ eₙ</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    ⦃ monoidₘ ⦄ <span class="ot">:</span> Monoid eₘ <span class="ot">_</span>∙ₘ<span class="ot">_</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    ⦃ monoidₙ ⦄ <span class="ot">:</span> Monoid eₙ <span class="ot">_</span>∙ₙ<span class="ot">_</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="kw">open</span> MonoidH ⦃ <span class="ot">...</span> ⦄</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="kw">instance</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  x^-MonoidH-ℕ+-ℕ* <span class="ot">:</span> <span class="ot">∀</span> <span class="ot">{</span>x <span class="ot">:</span> ℕ<span class="ot">}</span> <span class="ot">→</span> MonoidH <span class="dv">0</span> <span class="ot">_</span>+<span class="ot">_</span> <span class="dv">1</span> <span class="ot">_</span>*<span class="ot">_</span> <span class="ot">(</span>x ^<span class="ot">_)</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  P-∙ ⦃ x^-MonoidH-ℕ+-ℕ* <span class="ot">{</span>x<span class="ot">}</span> ⦄ zero b <span class="ot">=</span> trans <span class="ot">(</span>sym <span class="ot">(</span>∙-identityʳ <span class="ot">(</span>x ^ b<span class="ot">)))</span> refl <span class="co">-- </span><span class="al">FIXME</span><span class="co">: Why does this doesn&#39;t requires explicit passing instance</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  P-∙ ⦃ x^-MonoidH-ℕ+-ℕ* <span class="ot">{</span>x<span class="ot">}</span> ⦄ <span class="ot">(</span>suc a<span class="ot">)</span> b</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    <span class="kw">rewrite</span> P-∙ ⦃ x^-MonoidH-ℕ+-ℕ* <span class="ot">{</span>x<span class="ot">}</span> ⦄ a b</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="ot">|</span> sym <span class="ot">(</span>∙-assoc ⦃ ℕ*-monoid ⦄ x <span class="ot">(</span>x ^ a<span class="ot">)</span> <span class="ot">(</span>x ^ b<span class="ot">))</span> <span class="co">-- </span><span class="al">FIXME</span><span class="co">: And this requires?</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="ot">=</span> refl</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  P-id ⦃ x^-MonoidH-ℕ+-ℕ* ⦄ <span class="ot">=</span> refl</span></code></pre></div>
<blockquote>
<p> is x ^_ a commutative monoid homomorphism?</p>
</blockquote>
<p>Yeah, it’s a commutative monoid homomorphism. As a monoid morphism is
a super class of commutative monoid morphism, I’m not sure if I
represented that relation correctly in my proof.</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode agda"><code class="sourceCode agda"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>+-suc-swap <span class="ot">:</span> <span class="ot">∀</span> <span class="ot">(</span>m n <span class="ot">:</span> ℕ<span class="ot">)</span> <span class="ot">→</span> suc m + n ≡ m + suc n</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>+-suc-swap zero n <span class="ot">=</span> refl</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>+-suc-swap <span class="ot">(</span>suc m<span class="ot">)</span> n <span class="kw">rewrite</span> +-suc-swap m n <span class="ot">=</span> refl</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>+-comm <span class="ot">:</span> <span class="ot">∀</span> <span class="ot">(</span>m n <span class="ot">:</span> ℕ<span class="ot">)</span> <span class="ot">→</span> m + n ≡ n + m</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>+-comm zero n <span class="kw">rewrite</span> +-identityʳ n <span class="ot">=</span> refl</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>+-comm <span class="ot">(</span>suc m<span class="ot">)</span> n</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">rewrite</span> +-comm m n</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="ot">|</span> +-suc-swap n m</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="ot">=</span> refl</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>*-zeroˡ <span class="ot">:</span> <span class="ot">∀</span> <span class="ot">(</span>n <span class="ot">:</span> ℕ<span class="ot">)</span> <span class="ot">→</span> <span class="dv">0</span> * n ≡ <span class="dv">0</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>*-zeroˡ n <span class="ot">=</span> refl</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>*-zeroʳ <span class="ot">:</span> <span class="ot">∀</span> <span class="ot">(</span>n <span class="ot">:</span> ℕ<span class="ot">)</span> <span class="ot">→</span> n * <span class="dv">0</span> ≡ <span class="dv">0</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>*-zeroʳ zero <span class="ot">=</span> refl</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>*-zeroʳ <span class="ot">(</span>suc n<span class="ot">)</span> <span class="kw">rewrite</span> *-zeroʳ n <span class="ot">=</span> refl</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>*-comm <span class="ot">:</span> <span class="ot">∀</span> <span class="ot">(</span>m n <span class="ot">:</span> ℕ<span class="ot">)</span> <span class="ot">→</span> m * n ≡ n * m</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>*-comm zero n <span class="kw">rewrite</span> *-zeroʳ n <span class="ot">=</span> refl</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>*-comm <span class="ot">(</span>suc m<span class="ot">)</span> zero <span class="kw">rewrite</span> *-zeroʳ m <span class="ot">=</span> refl</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>*-comm <span class="ot">(</span>suc m<span class="ot">)</span> <span class="ot">(</span>suc n<span class="ot">)</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="kw">rewrite</span> *-comm m <span class="ot">(</span>suc n<span class="ot">)</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="ot">|</span> *-comm n <span class="ot">(</span>suc m<span class="ot">)</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="ot">|</span> *-comm m n</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="ot">|</span> sym <span class="ot">(</span>+-assoc n m <span class="ot">(</span>n * m<span class="ot">))</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="ot">|</span> +-comm n m</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="ot">|</span> +-assoc m n <span class="ot">(</span>n * m<span class="ot">)</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="ot">=</span> refl</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="kw">record</span> CommMonoid <span class="ot">{</span>A <span class="ot">:</span> <span class="dt">Set</span><span class="ot">}</span> <span class="ot">(</span>e <span class="ot">:</span> A<span class="ot">)</span> <span class="ot">(_</span>∙<span class="ot">_</span> <span class="ot">:</span> A <span class="ot">→</span> A <span class="ot">→</span> A<span class="ot">)</span> <span class="ot">:</span> <span class="dt">Set</span> <span class="kw">where</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="kw">field</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>   ∙-comm <span class="ot">:</span> <span class="ot">∀</span> <span class="ot">(</span>a b <span class="ot">:</span> A<span class="ot">)</span> <span class="ot">→</span> a ∙ b ≡ b ∙ a</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>   ⦃ monoid ⦄ <span class="ot">:</span> Monoid e <span class="ot">_</span>∙<span class="ot">_</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="kw">open</span> CommMonoid ⦃ <span class="ot">...</span> ⦄ <span class="kw">public</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="kw">instance</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  +-CommMonoid <span class="ot">:</span> CommMonoid <span class="dv">0</span> <span class="ot">_</span>+<span class="ot">_</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  +-CommMonoid <span class="ot">=</span> <span class="kw">record</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="ot">{</span> ∙-comm <span class="ot">=</span> +-comm</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>    <span class="ot">}</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  *-CommMonoid <span class="ot">:</span> CommMonoid <span class="dv">1</span> <span class="ot">_</span>*<span class="ot">_</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  *-CommMonoid <span class="ot">=</span> <span class="kw">record</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="ot">{</span> ∙-comm <span class="ot">=</span> *-comm</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    <span class="ot">}</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="kw">record</span> CommMonoidH</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    <span class="ot">{</span>M N <span class="ot">:</span> <span class="dt">Set</span><span class="ot">}</span> <span class="ot">(</span>eₘ <span class="ot">:</span> M<span class="ot">)</span> <span class="ot">(_</span>∙ₘ<span class="ot">_</span> <span class="ot">:</span> M <span class="ot">→</span> M <span class="ot">→</span> M<span class="ot">)</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    <span class="ot">(</span>eₙ <span class="ot">:</span> N<span class="ot">)</span> <span class="ot">(_</span>∙ₙ<span class="ot">_</span> <span class="ot">:</span> N <span class="ot">→</span> N <span class="ot">→</span> N<span class="ot">)</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    <span class="ot">(</span>f <span class="ot">:</span> M <span class="ot">→</span> N<span class="ot">)</span></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  <span class="ot">:</span> <span class="dt">Set</span> <span class="kw">where</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  <span class="kw">field</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>    P-comm <span class="ot">:</span> <span class="ot">∀</span> <span class="ot">(</span>a b <span class="ot">:</span> M<span class="ot">)</span> <span class="ot">→</span> f <span class="ot">(</span>a ∙ₘ b<span class="ot">)</span> ≡ f <span class="ot">(</span>b ∙ₘ a<span class="ot">)</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    ⦃ comm-monoidₘ ⦄ <span class="ot">:</span> CommMonoid eₘ <span class="ot">_</span>∙ₘ<span class="ot">_</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    ⦃ comm-monoidₙ ⦄ <span class="ot">:</span> CommMonoid eₙ <span class="ot">_</span>∙ₙ<span class="ot">_</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>    ⦃ monoidH ⦄ <span class="ot">:</span> MonoidH eₘ <span class="ot">_</span>∙ₘ<span class="ot">_</span> eₙ <span class="ot">_</span>∙ₙ<span class="ot">_</span> f</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a><span class="kw">open</span> CommMonoidH ⦃ <span class="ot">...</span> ⦄</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a><span class="kw">instance</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  x^-CommMonoidH-ℕ+-ℕ* <span class="ot">:</span> <span class="ot">∀</span> <span class="ot">{</span>x <span class="ot">:</span> ℕ<span class="ot">}</span> <span class="ot">→</span> CommMonoidH <span class="dv">0</span> <span class="ot">_</span>+<span class="ot">_</span> <span class="dv">1</span> <span class="ot">_</span>*<span class="ot">_</span> <span class="ot">(</span>x ^<span class="ot">_)</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>  P-comm ⦃ x^-CommMonoidH-ℕ+-ℕ* <span class="ot">{</span>x<span class="ot">}</span> ⦄ a b</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    <span class="kw">rewrite</span> ∙-comm ⦃ +-CommMonoid ⦄ a b</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    <span class="ot">=</span> refl</span></code></pre></div>
<blockquote>
<p> As a first hint, I’ll just suggest re-reading the second puzzle more
carefully and contrasting its wording with that of the first puzzle. I
think there’s more freedom in this question than you realized.</p>
</blockquote>
<p>Thank you for your suggestion to re-read the second puzzle more
carefully and contrasting its wording with that of the first puzzle. I
will give it more thought.</p>
<blockquote>
<p>Would you mind re-sending your note below (to which I’m responding)
and <strong>its P.S.</strong> as Markdown?</p>
</blockquote>
<blockquote>
<p>PS: I’m thinking that (x ^_) similar to a → x which is a
contravariant in the input type, and maybe I could use only the facts
that (x ^_) is contravariant, M and N are monoid to prove the
homomorphism properties.</p>
</blockquote>
<p>Regarding my P.S, it’s just initial ideal. I haven’t finished it yet.
I thought of that because I think (x ^_) is also a monoid morphism in
Cartesian Closed category, in the sense that:</p>
<ul>
<li>Function (exponential type) of a sum type is a product type of
function: (A ⊎ B) → C ≃ (A → C) × (B → C)</li>
<li>There is only one function from unit of sum type: ⊗ → A ≃ 1 – absurd
function</li>
</ul>
<p>So I think it could be the fact that exponential is homomorphism is
because (x ^_), <em>+</em>, and _*_ formed a Cartesian Closed
category.</p>
<p>Thank you</p>
